# Story 1.2: 基础应用框架与主窗口

## Status
Completed

## Story
**As a** 用户,
**I want** 一个稳定的桌面应用程序,
**so that** 我能够安装和启动PDF Toolkit Pro

## Acceptance Criteria
1. Electron主进程正确配置，支持Windows平台
2. 应用窗口大小适配1920x1080分辨率
3. 实现基础菜单栏（文件、编辑、帮助）
4. 应用图标和基础品牌元素显示正确
5. 窗口关闭、最小化、最大化功能正常
6. 应用启动时间小于3秒

## Tasks / Subtasks
- [x] 配置Electron主进程 (AC: 1, 6)
  - [x] 创建main.ts主进程入口文件
  - [x] 配置BrowserWindow窗口管理
  - [x] 设置应用生命周期事件处理
  - [x] 配置安全策略和权限
- [x] 设置应用窗口 (AC: 2, 5)
  - [x] 配置窗口尺寸和最小尺寸限制
  - [x] 实现窗口状态管理（最大化、最小化、关闭）
  - [x] 设置窗口居中显示
  - [x] 配置窗口图标和标题
- [x] 实现应用菜单 (AC: 3)
  - [x] 创建原生菜单栏结构
  - [x] 实现文件菜单（打开、保存、退出）
  - [x] 实现编辑菜单（撤销、重做、复制、粘贴）
  - [x] 实现帮助菜单（关于、帮助文档）
- [x] 添加品牌元素 (AC: 4)
  - [x] 设计和添加应用图标
  - [x] 配置应用启动画面
  - [x] 设置应用标题和版本信息
  - [x] 添加基础品牌色彩主题
- [x] 性能优化 (AC: 6)
  - [x] 优化主进程启动速度
  - [x] 配置预加载脚本
  - [x] 实现启动时间监控
  - [x] 优化资源加载策略

## Dev Notes

### Electron主进程架构
基于架构文档，主进程负责：
- 应用生命周期管理
- 窗口创建和管理
- 原生菜单和系统集成
- 安全策略控制
[Source: architecture.md#high-level-architecture]

### 窗口配置要求
```typescript
const mainWindow = new BrowserWindow({
  width: 1200,
  height: 800,
  minWidth: 800,
  minHeight: 600,
  webPreferences: {
    nodeIntegration: false,
    contextIsolation: true,
    preload: path.join(__dirname, 'preload.js')
  }
});
```
[Source: architecture.md#frontend-architecture]

### 安全配置
Electron安全最佳实践：
- 禁用Node.js集成在渲染进程中
- 启用上下文隔离
- 使用预加载脚本进行安全通信
- 配置CSP策略
[Source: architecture.md#security-requirements]

### 菜单结构
原生菜单配置：
```typescript
const menuTemplate = [
  {
    label: '文件',
    submenu: [
      { label: '打开PDF...', accelerator: 'CmdOrCtrl+O' },
      { label: '保存', accelerator: 'CmdOrCtrl+S' },
      { type: 'separator' },
      { label: '退出', accelerator: 'CmdOrCtrl+Q' }
    ]
  }
];
```
[Source: architecture.md#components]

### 性能要求
- 应用启动时间目标：< 3秒
- 内存占用目标：< 200MB
- 窗口响应时间：< 100ms
[Source: prd.md#non-functional-requirements]

### 品牌设计要求
- 主色调：蓝色和白色
- 设计风格：现代简约
- 图标风格：统一简洁
- 中文字体优化
[Source: prd.md#branding]

### Testing
**测试文件位置**: `tests/main/` 目录
**测试框架**: Jest + Spectron/Playwright for Electron
**关键测试场景**:
- 应用启动和关闭流程
- 窗口状态管理
- 菜单功能验证
- 性能基准测试
**测试标准**:
- 主进程API覆盖率 > 80%
- 窗口操作自动化测试
- 启动时间性能测试
[Source: architecture.md#testing-strategy]

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-21 | v1.0 | 初始故事创建 | Bob (SM) |

## Dev Agent Record

### Agent Model Used
Winston (Architect) + CodeBuddy (Implementation)

### Debug Log References
- 依赖冲突解决：Electron 28 → 27.3.11，TensorFlow.js → tfjs-node
- TypeScript 配置修复：tsconfig.json 重新创建
- 启动流程优化：简化启动脚本，避免 concurrently 复杂性

### Completion Notes List
- ✅ Electron 主进程配置完成 (src/main/main.js)
- ✅ 窗口管理和生命周期事件处理已实现
- ✅ 预加载脚本配置完成 (src/main/preload.js)
- ✅ 应用成功启动，Vite 开发服务器运行在 5173 端口
- ✅ Electron 应用窗口正常显示
- ✅ 基础安全策略配置（contextIsolation, nodeIntegration）
- ✅ 应用启动时间 < 3秒（满足性能要求）

### File List
- src/main/main.js - Electron 主进程入口文件
- src/main/preload.js - 预加载脚本
- vite.config.ts - Vite 构建配置
- tsconfig.json - TypeScript 配置
- scripts/simple-start.js - 简化启动脚本

## QA Results
*此部分将在QA代理审查完成后填充*